{% extends 'base.html' %}
{% block title %}Список заявок{% endblock %}


{% block content %}
{% include 'includes/operator_menu.html' %}
<div class="container-fluid ">
{% include 'includes/switcher2.html' %}

     {% include 'includes/paginator.html' %}
     <div class="container-fluid ">
     <table id="table" class="table table-bordered table-hover table-sm" style="font-size: 14px; line-height: 100%; padding: .1rem .1rem .1rem .1rem">
     <thead class="">
     <tr class="">
           <th>id</th>
           <th>T рег</th>
           <th>Shop</th>
           <th>Сумм</th>
           <th>Статус</th>
           <th>Подтв.<br>Сумм</th>
           <th>T подтв</th>
           <th>T изм</th>
           <th>Подтв. Сумм</th>
         <th>id платежа</th>
       </tr>
     </thead>
     <tbody style="text-align: end" >
         {% for payment in object_list %}
         <tr title="{{ payment.id }}" id="payment{{ payment.short_id }}"
                 {% if payment.status == -1 %}
                    class="table-secondary"
                 {% elif payment.confirmed_time%}
                     class="table-success"
                 {% endif %}>

            <td><a class="changelink" href="">{{ payment.short_id }}</a>
                {% if payment.comment %}
                  *
                {% endif %}
            </td>
            <td>{{ payment.create_at|date:"d.m H:i" }}</td>
            <td>{{ payment.shop.name}}</td>
            {% if payment.screenshot %}
              <td><a target="_blank" href="/media/{{ payment.screenshot }}">{{ payment.amount }}</a></td>
            {% else %}
              <td>{{ payment.amount }}</td>
            {% endif %}
            <form method="post" action=''>
            {% csrf_token %}
              <td style="white-space: nowrap">{{ payment.status_str }}
              {% if payment.status == 1 %}
                 <button name="cancel_payment" value="{{ payment.id }}" style="margin-bottom: -10px; margin-top: -10px; height: 25px;font-size: small" type="submit" class="btn btn-danger btn-sm">X</button>
              {% endif %}
              </td>
            </form>

            <td>{{ payment.confirmed_amount|default_if_none:""  }}</td>
            <td>{{ payment.confirmed_time|default_if_none:"-"  }}</td>
            <td>{{ payment.change_time }}</td>

            {% load l10n %}
            {% localize off %}
            <form action="" method="post">
            {% csrf_token %}
                <td title="">


                <input type="text"
                       {% if payment.confirmed_amount %}
                       value="{{ payment.confirmed_amount }}"
                       {% else %}
                       value="{{ payment.amount }}"
                       {% endif %}
                       name="confirm_amount_value:{{ payment.id }}"
                       size="5">

            </td>

            <td class="text-nowrap">

                    <input type="text"
                           value="{{ payment.incoming.id }}"
                           name="incoming_id_value:{{ payment.id }}"
                           size="7">
                    {% if payment.status != 1 %}
                      <button disabled name="payment_id:{{ payment.id }}" type="submit" class="btn btn-warning btn-sm">---</button>
                     {% else %}
                        <button name="payment_id:{{ payment.id }}" type="submit" class="btn btn-warning btn-sm">OK</button>
                     {% endif %}

            </td>
            {% endlocalize %}
</form>

         </tr>
         {% endfor %}

     </tbody>
   </table>
   </div>
   {% include 'includes/paginator.html' %}

</div>

{% endblock %}
