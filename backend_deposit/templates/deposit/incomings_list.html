{% extends 'base.html' %}
{% block title %}Список платежей{% endblock %}


{% block content %}
{% include 'includes/operator_menu.html' %}
<div class="">
{% include 'includes/switcher2.html' %}
   <table class="table table-sm" style="font-size: medium">
     <thead class="thead-dark align-content-center">
     {% with request.resolver_match.view_name as view_name %}
         {% if view_name == 'deposit:incomings_filter' %}
             Ваш фильтр на получателя: {{ user.profile.my_filter }}
             <a class="changelink" href="{% url 'deposit:my_filter' %}">Изменить</a>
         {% endif %}
     {% endwith %}

     <tr>
           <th>id</th>
           <th>Поступил</th>
           <th>Время на чеке</th>
           <th>Получатель</th>
           <th>Отправитель</th>
           <th>Платеж</th>
           <th>Баланс</th>
           <th>Источник</th>
           <th>Транзакция</th>
           <th>Бирпай</th>
       </tr>
     </thead>
     <tbody>
         {% for incoming in page_obj %}
         <tr>
            <td><a class="changelink" href="{% url 'deposit:incoming_edit' incoming.id %}">{{ incoming.id }}</a></td>
            <td>{{ incoming.register_date|date:"d.m.Y H:i" }}</td>
            <td>{{ incoming.response_date|date:"d.m.Y H:i" }}</td>
            <td>{{ incoming.recipient }}</td>

            <td style="background: {{ incoming.color_back }}">{{ incoming.sender }}</td>
            <td>{{ incoming.pay }}</td>
            <td>{{ incoming.balance }}</td>
            <td>{{ incoming.worker|default_if_none:"" }}</td>
            <td>{{ incoming.transaction|default_if_none:"" }}</td>

            <td>
                <form action="{% url 'deposit:incomings' %}" method="post">
                                    {% csrf_token %}
                    <input type="text" style="font-size: medium; height: 20px" minlength="0" maxlength="12" size="9"  value="{{ incoming.birpay_id|default_if_none:""  }}" name="{{ incoming.id }}">
                    {% if incoming.birpay_id %}
                      <button disabled type="submit" class="btn btn-primary btn-sm">---</button>
                    {% else %}
                      <button style="height: 25px;font-size: small; align-content: center; align-items: center; align-self: center; justify-content: center" type="submit" class="btn btn-primary btn-sm">Ok</button>
                    {% endif %}
                </form>
            </td>

         </tr>
         {% endfor %}
     </tbody>
   </table>
   {% include 'includes/paginator.html' %}
</div>
{% endblock %}